<?xml version="1.0" encoding="UTF-8"?>
<ui:composition template="/WEB-INF/templates/default.xhtml"
	xmlns="http://www.w3.org/1999/xhtml"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:a4j="http://richfaces.org/a4j"
	xmlns:rich="http://richfaces.org/rich"
	xmlns:my="http://java.sun.com/jsf/composite/components">
	<ui:define name="content">
		<h1>Промяна на пациентски статус</h1>

		<h:form id="form">
			<rich:dataTable value="#{carsBean.allAdmittedPatients}"
				var="patient" iterationStatusVar="it" id="table">
				<rich:column>
					<f:facet name="header">Име</f:facet>
					<h:outputText value="#{patient.family}" />
				</rich:column>
				<rich:column>
					<f:facet name="header">ЕГН</f:facet>
					<h:outputText value="#{patient.egn}" />
				</rich:column>
				<rich:column>
					<a4j:commandLink styleClass="no-decor" render="editGrid"
						execute="@this" oncomplete="#{rich:component('editPane')}.show()" value="Obnovi">
						
						<f:setPropertyActionListener
							target="#{carsBean.editedPatient}" value="#{patient}" />
					</a4j:commandLink>
				</rich:column>

			</rich:dataTable>


			<rich:popupPanel header="Edit Car Details" id="editPane"
				domElementAttachment="parent" width="400" height="170">
				<h:panelGrid columns="3" id="editGrid">
					<h:outputText value="Име:" />
					<h:outputText value="#{carsBean.editedPatient.firstname}" />
					<h:panelGroup />
					<h:outputText value="Фамилия" />
					<h:inputText value="#{carsBean.editedPatient.egn}" />

					<a4j:commandButton value="Запази"
						action="#{carsBean.updatePatient()}" render="table"
						execute="editPane"
						oncomplete="if (#{facesContext.maximumSeverity==null}) {#{rich:component('editPane')}.hide();}" />
					<a4j:commandButton value="Отмени"
						onclick="#{rich:component('editPane')}.hide(); return false;" />
				</h:panelGrid>
			</rich:popupPanel>
		</h:form>
	</ui:define>

</ui:composition>

